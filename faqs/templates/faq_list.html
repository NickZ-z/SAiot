{% extends 'base.html' %}
{% load static %}

{% block title %}
SUAP - Sistema administrativo da Internet das Coisas
{% endblock %}

{% block link %}

{% endblock %}

{% block main %}

{% if user.is_authenticated %}



<div class="container">
<h2>{{ categoria.nome }} FAQs</h2>
<br>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="{% static 'js/error_device.js' %}"></script>

<script>
    $(document).ready(function(){
        $("#formPergunta").submit(function(){
            var pergunta = $("#pergunta").val();
            var descricao = $("#descricao").val();

            if(pergunta.trim() === "" || descricao.trim() === "") {
                alert("Por favor, preencha tanto a pergunta quanto a descrição.");
                return false; 
            }
        });
    });
</script>
<h2>Tire suas dúvidas</h2>
<form method="post" action="{% url 'enviar_pergunta' categoria_id=categoria.id %}" id="formPergunta" class="mt-3">
    {% csrf_token %}
    <div class="form-group">
        <label for="pergunta">Pergunta:</label>
        <textarea class="form-control" name="pergunta" id="pergunta"></textarea>
    </div>
    <div class="form-group">
        <label for="descricao">Descrição:</label>
        <textarea class="form-control" name="descricao" id="descricao"></textarea>
    </div>
    <br>
    <button type="submit" class="btn btn-primary">Enviar Pergunta</button>
    <hr>
</form>

<ul class="list-group">
    {% for faq in faqs %}
        <li class="list-group-item">
            <h3>Dúvida:</h3>
            <p>Pergunta: {{ faq.pergunta }}</p>
            <br>
            <p>Descrição: {{faq.descricao}}</p>
            <h4>Resposta:</h4>
            <p>{{ faq.resposta }}</p>

            <form method="post" action="{% url 'enviar_resposta' faq_id=faq.id %}" class="mt-3">
                {% csrf_token %}
                <div class="form-group">
                    <label for="resposta">Resposta:</label>
                    <textarea class="form-control" name="resposta" id="resposta"></textarea>
                </div>
                <br>
                <button type="submit" class="btn btn-primary">Enviar Resposta</button>
            </form>
        </li>
        <hr>
    {% endfor %}
</ul>

</div>
{% else %}
    <div class="d-flex justify-content-center align-items-center" style="height: 290px;">
        <p>
            <strong>Para acessar o sistema, é necessário estar logado em um perfil de servidor.</strong>
        </p>
    </div>
{% endif %}



<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="{% static 'js/error_device.js' %}"></script>
{% endblock %}
